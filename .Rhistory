d[d==0] <- NA
View(d)
ids <- unique(d$id)
describe(d$corr)
describe(d$inc)
# end <- 18000
start <- 0
# binsize <- 1000
# try smaller bins:
binsize <- 40
maxbin <- 16800
c <- data.frame()
for (id in ids)
## Lizzie, here you can insert the if condition that sets a different end for some ids, or just set end to equal the time of last response
{end <- max(c(max(d$inc[d$id==id]),max(na.omit(d$corr[d$id==id]))))
# make sure we are not removing idle time at the end of sessions for those 5-6 mice
if (end>maxbin) {end <- 18000}
bins <- seq(start,end,binsize)
t=cut(d$corr[d$id==id],c(bins), labels = FALSE)
b <- table( factor(t, levels = 1:length(bins)-1))
b <- as.data.frame(b)
b$id <- id
names(b)[names(b)=="Var1"] <- "time"
names(b)[names(b)=="Freq"] <- "corr"
tinc=cut(d$inc[d$id==id],c(bins), labels = FALSE)
i <- table( factor(tinc, levels = 1:length(bins)-1))
i <- as.data.frame(i)
b$inc <- i$Freq
c <- rbind(c,b)
}
c <- c[c$time!="0",]
c$t.ord <- as.ordered(c$time)
c$t.num <- as.numeric(c$time)
plot(c$time,c$inc)
plot(c$time,c$corr)
hist(c$inc)
hist(c$corr)
length(c$inc)
ggplot(aes(x=t.num, y=corr),data = c) + stat_smooth(size=2, alpha=0.2, method="gam", formula = y ~ s(x), size = 1) + theme_bw(base_size=20) + xlab("Time, 200s bins") + ylab("Correct responses") +
stat_smooth(data=c, aes(x=t.num, y=corr), size=0.4, alpha=0.1, se=FALSE, method="loess")
ggplot( aes(x=t.num, y=inc),data = c) + stat_smooth(size=2, alpha=0.2, method="gam", formula = y ~ s(x), size = 1) + theme_bw(base_size=20) + xlab("Time, 200s bins") + ylab("Incorrect responses") +
stat_smooth(data=c, aes(x=t.num, y=inc), size=0.4, alpha=0.1, se=FALSE, method="loess")
# set up negative binomial models
# estimate overdispersion parameter theta
theta.corr <- theta.ml(c$corr, mean(c$corr), 513, limit = 50, eps = .Machine$double.eps^.25, trace = FALSE)
theta.inc <- theta.ml(c$inc, mean(c$inc), 513, limit = 50, eps = .Machine$double.eps^.25, trace = FALSE)
# for correct presses
#summary(mcorr1 <- glm(corr ~ t.ord + (1:id), family = negative.binomial(theta = theta.corr), data = c))
summary(mcorr2 <- glm(corr ~ t.num + (1:id), family = negative.binomial(theta = theta.corr), data = c))
# for incorrect presses
summary(minc1 <- glm(inc ~ t.num + (1:id), family = negative.binomial(theta = theta.corr), data = c))
# combine all responses into one variable with correct/incorrect as factor
c.all <- melt(c,id.vars = c("id","time","t.num","t.ord"),value.name = "response", variable.name = "type")
names(c.all)[names(c.all)=="value"] <- "response"
names(c.all)[names(c.all)=="variable"] <- "type"
View(c.all)
nbfit <- suppressWarnings(fitdistr(c.all$response, "negative binomial"))
nbfit$estimate
logLik(nbfit)
#remove bins with no data
# censored <- c(54:55,124:126,156:162,230:234,249:252,335:342,359:360,371:378,411:414,449:450,540:541,610:612,642:648,716:720,735:738,821:828,845:846,857:864,897:900,935:936)
# censoredtemp <- censored*1000/binsize;
# c.all[c(censoredtemp),c('response')] <- "NA"
# c.all[c(54,124:126,156:162,230:234,249:252,335:342,359:360,371:378,411:414,449:450,540,610:612,642:648,716:720,735:738,821:828,845:846,857:864,897:900,935,936),c('response')] <- "NA"
c.all$response <- as.numeric(c.all$response)
pdf("Response curves gam.pdf", width=8, height=6)
ggplot(aes(x=t.num, y=log(response + .1), color = type),data = c.all) + theme_bw(base_size=20) + xlab("Time, 200s bins") + ylab("Responses (log)") +
stat_smooth(data=c.all, aes(x=t.num, y=log(response + .1), color = type), size=2, alpha=0.2, se=TRUE, method="loess") + geom_count(position = "jitter")
dev.off()
ggplot(aes(x=t.num, y=response, color = type),data = c.all) + stat_smooth(size=2, alpha=0.2, method="gam", formula = y ~ s(x), size = 1) +
theme_bw(base_size=20) + xlab("Time, 200s bins") + ylab("Responses") +
geom_count(position = "jitter")
# merge with genotype
# corr/inc separated
hdf <- merge(c,g) # horizontal data frame
ggplot(aes(x=t.num, y=corr, color = Genotype),data = hdf) + stat_smooth(size=2, alpha=0.1, method="loess", size = 1) + theme_bw(base_size=20) +
xlab("Time, 200s bins") + ylab("Correct responses") +
geom_count(position = "jitter")
ggplot( aes(x=t.num, y=inc, color = Genotype),data = hdf) + stat_smooth(size=2, alpha=0.1, method="loess",  size = 1) + theme_bw(base_size=20) +
xlab("Time, 200s bins") + ylab("Incorrect responses") +
geom_count(position = "jitter")
# all together
bdf <- merge(c.all,g)
names(cfos)[names(cfos)=="grooming time"] <- "grooming.time"
# merge with cell counts
hdfc <- merge(hdf,cfos)
bdfc <- merge(bdf,cfos)
pdf("Log response curves by genotype gam.pdf", width=8, height=6)
ggplot(aes(x=t.num, y=log(response + .1), color = type),data = bdf) + theme_bw(base_size=20) + xlab("Time, 200s bins") + ylab("Responses (log)") +
stat_smooth(data=bdf, aes(x=t.num, y=log(response + .1), color = type), size=2, alpha=0.2, se=TRUE, method="loess") + geom_count(position = "jitter") +
facet_grid(Genotype ~ .)
dev.off()
pdf("Linear response curves by genotype gam.pdf", width=8, height=6)
ggplot(aes(x=t.num, y=response, color = type),data = bdf) + stat_smooth(size=2, alpha=0.2, method="gam", formula = y ~ s(x), size = 1) +
theme_bw(base_size=20) + xlab("Time, 200s bins") + ylab("Responses") +
geom_count(position = "jitter") +
facet_grid(Genotype ~ .)
dev.off()
#  quick look at genotype
# correct
summary(mcorrg1 <- glm(corr ~ t.num*Genotype +  (1:id), family = negative.binomial(theta = theta.corr), data = hdf))
#incorrect
summary(mincg1 <- glm(inc ~ t.num*Genotype +  (1:id), family = negative.binomial(theta = theta.inc), data = hdf))
summary(lmc1 <- lm(cfos$tot_correct ~ cfos$genotype01))
summary(lmi1 <- lm(cfos$tot_incorrect ~ cfos$genotype01))
summary(lmg1 <- lm(log(cfos$grooming.time) ~ cfos$genotype01))
# both
# calculate theta for both responses
# AD: this was previously not working, and all the models were run on the old theta estimate, which was incorrect
# LM 082717: yes I see that now the Genotype x type x time is highly significant
theta.resp <- theta.ml(na.omit(c.all$response), mean(na.omit(c.all$response)), 972, limit = 50, eps = .Machine$double.eps^.25, trace = FALSE)
summary(mrespg1 <- glm(response ~ 1 + t.num*type + type*Genotype +  (1:id), family = negative.binomial(theta = theta.resp), data = bdf))
# LM 082717 CAR::ANOVA output did not provide analysis related to genotype x type x time ineteraction?
car::Anova(mrespg1)
#GRAPH NAcS
summary(mrespg4 <- glm(response ~ t.num*type+ t.num*Genotype + type*Genotype + NAcS*t.num*type + NAcS*t.num*Genotype + NAcS*type*Genotype + (1:id), family = negative.binomial(theta = theta.resp), data = bdfc))
car::Anova(mrespg4)
leastsquare = lsmeans::lsmeans(mrespg4, pairwise ~ NAcS:Genotype:type, at = list(NAcS = c(50,150,250)), adjust='tukey')
library(dplyr)
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "NAcS plot pretty PRETTY.pdf", width = 10, height = 6)
pd = position_dodge(15)    ### How much to jitter the points on the plot
pd = position_dodge(35)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = NAcS, y = lsmean, color = Genotype, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Nucleus Accumbens Shell cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(40, 40, 40, 40, 40, 40,40, 40, 40, 40, 40, 40),
nudge_y = c(0,  0, 0,  0, 0 , 0,0,0, .05,  -.05, 0, 0), color   = "magenta3","black") +
# nudge_y = 0, color   = "black") +
scale_color_manual(values = c("magenta3","black"))
dev.off()
ggplot(CLD, aes( x = NAcS, y = lsmean, color = Genotype, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Nucleus Accumbens Shell cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(1,  1, 1,  1, 1 , 1,1,1, 1,  1, 1, 1), color   = "black") +
# nudge_y = 0, color   = "black") +
scale_color_manual(values = c("magenta3","black"))
dev.off()
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "NAcS plot pretty PRETTY.pdf", width = 10, height = 6)
pd = position_dodge(35)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = NAcS, y = lsmean, color = Genotype, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Nucleus Accumbens Shell cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(1,  1, 1,  1, 1 , 1,1,1, 1,  1, 1, 1), color   = "black") +
# nudge_y = 0, color   = "black") +
scale_color_manual(values = c("magenta3","black"))
dev.off()
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "NAcS plot pretty PRETTY.pdf", width = 10, height = 6)
pd = position_dodge(35)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = NAcS, y = lsmean, color = Genotype, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Nucleus Accumbens Shell cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(0,  0, 0,  0, 0 , 0,0,0, .05,  -.05, 0, 0), color   = "black") + nudge_y = 0, color   = "magenta3") +
scale_color_manual(values = c("magenta3","black"))
dev.off()
#pR GRAPH
summary(mrespg6 <- glm(response ~ t.num*type+ t.num*Genotype + type*Genotype + PrL*t.num*Genotype + PrL*type*Genotype + PrL*type*t.num +  (1:id), family = negative.binomial(theta = theta.resp), data = bdfc))
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "NAcS plot pretty PRETTY.pdf", width = 10, height = 6)
pd = position_dodge(35)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = NAcS, y = lsmean, color = Genotype, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Nucleus Accumbens Shell cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(0,  0, 0,  0, 0 , 0,0,0, .05,  -.05,-.05, -.05), color   = "black") +
#nudge_y = 0, color   = "magenta3") +
scale_color_manual(values = c("magenta3","black"))
dev.off()
hist(cfos$CMS)
median(cfos$CMS)
mean(cfos$CMS)
sd(cfos$CMS)
summary(mrespg3 <- glm(response ~ t.num*type+ t.num*Genotype + type*Genotype + DLS*t.num*Genotype + DLS*type*Genotype + DLS*type*t.num +  (1:id), family = negative.binomial(theta = theta.resp), data = bdfc))
car::Anova(mrespg3)
leastsquare = lsmeans::lsmeans(mrespg3, pairwise ~ DLS:t.num:type, at = list(DLS = c(10,100,200),t.num = c(bins[2],bins[length(bins)]/2, bins[length(bins)])), adjust='tukey')
library(dplyr)
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "DLS plot pretty time.pdf", width = 10, height = 6)
pd = position_dodge(15)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = DLS, y = lsmean, color = t.num, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Dorsolateral striatum cfos") +
ggtitle ("Behavior in reversal phase by time, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(0,  0, 0,  0, 0 , 0,0,0, .05,  -.05, 0, 0), color   = "black") +
# nudge_y = 0, color   = "black") +
scale_color_manual(values = c("black","black"))
dev.off()
#GRAPH NAcS genotype x time
summary(mrespg4 <- glm(response ~ t.num*type+ t.num*Genotype + type*Genotype + NAcS*t.num*type + NAcS*t.num*Genotype + NAcS*type*Genotype + (1:id), family = negative.binomial(theta = theta.resp), data = bdfc))
car::Anova(mrespg4)
leastsquare = lsmeans::lsmeans(mrespg4, pairwise ~ NAcS:Genotype:t.num, at = list(NAcS = c(50,150,250),t.num = c(bins[2],bins[length(bins)]/2, bins[length(bins)])), adjust='tukey')
library(dplyr)
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "NAcS plot pretty genotype x time.pdf", width = 10, height = 6)
pd = position_dodge(35)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = NAcS, y = lsmean, color = t.num, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Nucleus Accumbens Shell cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(0,  0, 0,  0, 0 , 0,0,0, .05,  -.05, 0, 0), color   = "black") +
#nudge_y = 0, color   = "magenta3") +
scale_color_manual(values = c("magenta3","black"))
dev.off()
leastsquare = lsmeans::lsmeans(mrespg4, pairwise ~ NAcS:Genotype:t.num, at = list(NAcS = c(50,150,250),t.num = c(1,225,449)), adjust='tukey')
library(dplyr)
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "NAcS plot pretty genotype x time.pdf", width = 10, height = 6)
pd = position_dodge(35)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = NAcS, y = lsmean, color = t.num, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Nucleus Accumbens Shell cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and time") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(0,  0, 0,  0, 0 , 0,0,0, .05,  -.05, 0, 0), color   = "black") +
#nudge_y = 0, color   = "magenta3") +
scale_color_manual(values = c("magenta3","black"))
dev.off()
#GRAPH mOFC
summary(mrespg8 <- glm(response ~ t.num*type+ t.num*Genotype + type*Genotype + mOFC*t.num*Genotype + mOFC*type*Genotype + mOFC*type*t.num +  (1:id), family = negative.binomial(theta = theta.resp), data = bdfc))
car::Anova(mrespg8)
leastsquare = lsmeans::lsmeans(mrespg8, pairwise ~ mOFC:Genotype:type, at = list(mOFC = c(400,700,1000)), adjust='tukey')
library(dplyr)
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "mOFC plot pretty PRETTY.pdf", width = 10, height = 6)
pd = position_dodge(15)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = mOFC, y = lsmean, color = Genotype, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Medial orbitofrontal cortex cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(0,  0, 0,  0, 0 , 0,0,0, .05,  -.05, 0, 0), color   = "black") +
# nudge_y = 0, color   = "black") +
scale_color_manual(values = c("magenta","black")) #KO first
dev.off()
#CMS GRAPH
summary(mrespg11 <- glm(response ~ t.num*type+ t.num*Genotype + type*Genotype + CMS*t.num*Genotype + CMS*type*Genotype + CMS*type*t.num +  (1:id), family = negative.binomial(theta = theta.resp), data = bdfc))
#GRAPH mOFC
summary(mrespg8 <- glm(response ~ t.num*type+ t.num*Genotype + type*Genotype + mOFC*t.num*Genotype + mOFC*type*Genotype + mOFC*type*t.num +  (1:id), family = negative.binomial(theta = theta.resp), data = bdfc))
car::Anova(mrespg8)
leastsquare = lsmeans::lsmeans(mrespg8, pairwise ~ mOFC:Genotype:type, at = list(mOFC = c(400,700,1000)), adjust='tukey')
library(dplyr)
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "mOFC plot pretty PRETTY.pdf", width = 10, height = 6)
#GRAPH mOFC
summary(mrespg8 <- glm(response ~ t.num*type+ t.num*Genotype + type*Genotype + mOFC*t.num*Genotype + mOFC*type*Genotype + mOFC*type*t.num +  (1:id), family = negative.binomial(theta = theta.resp), data = bdfc))
car::Anova(mrespg8)
leastsquare = lsmeans::lsmeans(mrespg8, pairwise ~ mOFC:Genotype:type, at = list(mOFC = c(400,700,1000)), adjust='tukey')
library(dplyr)
CLD = cld(leastsquare, alpha=0.05, Letters=letters,
adjust='tukey')
CLD$type <- recode_factor(CLD$type,corr="Correct",inc="Incorrect")
pdf(file = "mOFC plot pretty PRETTY.pdf", width = 10, height = 6)
pd = position_dodge(15)    ### How much to jitter the points on the plot
ggplot(CLD, aes( x = mOFC, y = lsmean, color = Genotype, label = .group)) +
facet_wrap( ~ type) +
geom_point(shape  = 16,
size   = 4,
position = pd) +
geom_errorbar(
aes(ymin  =  asymp.LCL,
ymax  =  asymp.UCL),
width =  0.2,
size  =  0.7,
position = pd
) +  theme_bw() +  theme(
axis.title   = element_text(face = "bold"),
axis.text    = element_text(face = "bold"),
plot.caption = element_text(hjust = 0)
) +  ylab("Log-probability of response") + xlab("Medial orbitofrontal cortex cfos") +
ggtitle ("Behavior in reversal phase by genotype, regional cfos level, and response type") +
labs( caption  = paste0(
"\n",
"Boxes indicate the LS mean.\n",
"Error bars indicate the 95% ",
"confidence interval of the LS mean, Sidak method for 12 estimates. \n",
"Means sharing a letter are ",
"not significantly different ",
"(Tukey-adjusted comparisons for 12 estimates)."),
hjust = 0.5 ) +
geom_text(nudge_x = c(20, 10, 20, 10, 10, 10,10, 10, 10, 10, 10, 10),
nudge_y = c(0,  0, 0,  0, 0 , 0,0,0, .05,  -.05, 0, 0), color   = "black") +
# nudge_y = 0, color   = "black") +
scale_color_manual(values = c("magenta","black"))
dev.off()
